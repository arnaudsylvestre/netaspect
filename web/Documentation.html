<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png">

    <title>NetAspect</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap-3.0.2/dist/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="jumbotron.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
<!-- Docs page layout -->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
		<div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Home</a>
        </div>
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Net Aspect</a>
        </div>
		<div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="GettingStarted.html">Getting started</a>
        </div>
		<div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="Documentation.html">Documentation</a>
        </div>
      </div>
    </div>

<div class="container bs-docs-container">
      <div class="row">
        
        <div class="col-md-12" role="main">
            <!-- Glyphicons
  ================================================== -->
  <div class="bs-docs-section">
    <div class="page-header">
      <h1 id="attributes">Basics</h1>
    </div>
	
    <h3 id="dropdowns-example">The sample class</h3>
    <p>Imagine that we want to log the different access on the following class : </p>
    <pre class="prettyprint">
public class MyInt
{
   int value;
   
   public MyInt(int value)
   {
      this.value = value;
   }
   
   public int Value
   {
      get { return value; }
   }
   
   public int DivideBy(int v)
   {
      return value / v;
   }
}
</pre>

<h3 id="dropdowns-example">Define the aspect</h3>
    <p>Imagine that we want to print <b>"Start Division"</b> in the console before executing the <b>DivideBy</b> method. We must create a class like this :</p>
	<pre class="prettyprint">
// NetAspect uses .Net attributes to define the weaving model
public class LogAttribute : Attribute
{
    // You must add this field to declare a NetAspectAttribute
    public bool NetAspectAttribute = true;
	
    // This method will be call before executing the DivideBy method thanks to the 'Before' method name
    public void Before() { Console.WriteLine("Start Division"); }
}
</pre>
<h3 id="dropdowns-example">Link the method with the aspect</h3>
    <p>Now, just add the attribute to the DivideBy method</p>
	<pre class="prettyprint">
public class MyInt
{
  private readonly int value;

  public MyInt(int value)
  {
	 this.value = value;
  }

  public int Value
  {
	 get { return value; }
  }

  [Log]
  public int DivideBy(int v)
  {
	 return value / v;
  }
}
</pre>
  </div>


  <!-- Dropdowns
  ================================================== -->
  <div class="bs-docs-section">
    <div class="page-header">
      <h1 id="dropdowns">Weaving</h1>
    </div>
        
<h2 id="dropdowns">Method Weaving</h2>
    <h3 id="dropdowns-example">Theory in NetAspect</h3>
    <p>The "method weaving" will modify the code of the method to add behavior. It is possible to add behavior :</p>
	<ul>
		<li><b>Before</b> the method is executed</li>
		<li><b>After</b> the method is executed when no exception is raised</li>
		<li><b>When exception occurs</b> in the method</li>
		<li><b>On finally</b> : at the end of the method when an exception is raised or not</li>
	</ul>
    <p>For each of these behaviors, we can get some information about the weaved method by adding some parameters to the aspect method :</p>
	<ul>
		<li><b>instance</b> : the <i>this</i> of the weaved method. The type of instance can be <b>object</b> or the real type (<b>MyInt</b> in our case)</li>
		<li><b>method</b> : the MethodInfo of the weaved method (in our case Divide)</li>
		<li><b>property</b> : the PropertyInfo of the property if the aspect is put on a property</li>
		<li><b>parameters</b> : the parameters of the weaved method (in our case the parameters of the Divide method). The type of parameters must be <b>object[]</b></li>
		<li><b>parameter name</b> : if a parameter name in the aspect method is in the weaved method so the value will be the same. You can referenced the parameter in the aspect method to update the value in the weaved method</li>
		<li><b>result</b> : the value returned by the weaved method. You can referenced the result in the aspect method to update the result value in the weaved method. The type of result must be the same type as the weaved method</li>
		<li><b>exception</b> : the exception raised in the weaved method. The type of this parameter must be <b>System.Exception</b></li>
		<li><b>value</b> : the new value of the property in a property setter</li>
	</ul>
	<p>Here is a sample with parameters</p>
	
	<pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool IsNetAspectAttribute { get { return true; } }
	
    public void Before(MyInt instance, int v) 
    {
        Console.WriteLine(string.Format("Start Division {0} / {1}", instance.Value, v));
    }
}
</pre>

<h3 id="dropdowns-example">Method weaving possibilities</h3>	
<h4 id="dropdowns-example">Method weaving</h4>
	
	<p>These aspects are called when the aspect is put on a <b>method</b></p>
	<p>The <b>BeforeMethod</b> method is called before the method is executed. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>method</li>
		<li>parameters</li>
		<li>parameter name</li>
	</ul>
	<p>The <b>AfterMethod</b> method is called after the method is executed. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>method</li>
		<li>parameters</li>
		<li>parameter name</li>
		<li>result</li>
	</ul>
	<p>The <b>OnExceptionMethod</b> method is called when an exception occured in the method. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>method</li>
		<li>parameters</li>
		<li>parameter name</li>
		<li>exception</li>
	</ul>
	<p>The <b>OnFinallyMethod</b> method is called after the method is executed when an exception occured or not. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>method</li>
		<li>parameters</li>
		<li>parameter name</li>
	</ul>
<h4 id="dropdowns-example">Constructor weaving</h4>
	
	<p>These aspects are called when the aspect is put on a <b>method</b></p>
	<p>The <b>BeforeMethod</b> method is called before the method is executed. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>constructor</li>
		<li>parameters</li>
		<li>parameter name</li>
	</ul>
	<p>The <b>AfterMethod</b> method is called after the method is executed. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>constructor</li>
		<li>parameters</li>
		<li>parameter name</li>
	</ul>
	<p>The <b>OnExceptionMethod</b> method is called when an exception occured in the method. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>constructor</li>
		<li>parameters</li>
		<li>parameter name</li>
		<li>exception</li>
	</ul>
	<p>The <b>OnFinallyMethod</b> method is called after the method is executed when an exception occured or not. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>constructor</li>
		<li>parameters</li>
		<li>parameter name</li>
	</ul>
	
<h4 id="dropdowns-example">Property getter weaving</h4>
	
	<p>These aspects are called when the aspect is put on a <b>property</b></p>
	<p>The <b>BeforePropertyGetMethod</b> method is called before the getter is executed. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>property</li>
	</ul>
	<p>The <b>AfterPropertyGetMethod</b> method is called after the getter is executed. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>property</li>
		<li>result</li>
	</ul>
	<p>The <b>OnExceptionPropertyGetMethod</b> method is called when an exception occured in the getter. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>property</li>
		<li>exception</li>
	</ul>
	<p>The <b>OnFinallyPropertyGetMethod</b> method is called after the getter is executed when an exception occured or not. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>property</li>
	</ul>
	
<h4 id="dropdowns-example">Property setter weaving</h4>
	
	<p>These aspects are called when the aspect is put on a <b>property</b></p>
	<p>The <b>BeforePropertySetMethod</b> method is called before the setter is executed. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>property</li>
		<li>value</li>
	</ul>
	<p>The <b>AfterPropertySetMethod</b> method is called after the setter is executed. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>property</li>
		<li>value</li>
	</ul>
	<p>The <b>OnExceptionPropertySetMethod</b> method is called when an exception occured in the setter. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>property</li>
		<li>value</li>
		<li>exception</li>
	</ul>
	<p>The <b>OnFinallyPropertySetMethod</b> method is called after the setter is executed when an exception occured or not. The available parameters are :</p>
	<ul>
		<li>instance</li>
		<li>property</li>
		<li>value</li>
	</ul>

	
<h2 id="dropdowns">Call Weaving</h2>
    <h3 id="dropdowns-example">Theory in NetAspect</h3>
    <p>The "call weaving" will modify the code of the method which call the member with the aspect to add behavior. It is possible to add the following behaviors :</p>
	<ul>
		<li><b>Before</b> the member is called</li>
		<li><b>After</b> the member is called</li>
	</ul>
    <p>For each of these behaviors, we can get some information about the caller and the member called by adding some parameters to the aspect method :</p>
	<ul>
		<li><b>caller</b> : the <i>this</i> of the method which call our member. The type of caller can be <b>object</b> or the real type</li>
		<li><b>callerMethod</b> : the MethodInfo of the method which call our member</li>
		<li><b>callerParameters</b> : the parameters of the method which call our member. The type of callerParameters must be <b>object[]</b></li>
		<li><b>caller + parameter name</b> : the parameter of the method which call our member</li>
		<li><b>called</b> : the <i>this</i> of our member. The type of called can be <b>object</b> or the real type</li>
		<li><b>calledParameters</b> : the parameters of our member if our member is a method. The type of calledParameters must be <b>object[]</b></li>
		<li><b>called + parameter name</b> : the parameter of our member if our member is a method</li>
		<li><b>lineNumber</b> : the line number of the instruction which call our member</li>
		<li><b>columnNumber</b> : the column number of the instruction which call our member</li>
		<li><b>filePath</b> : the file path of the instruction which call our member</li>
		<li><b>fileName</b> : the file name of the instruction which call our member</li>
	</ul>
    <h3 id="dropdowns-example">Sample</h3>
    <p>Here is a sample to get the line number of the code which call our DivideBy method</p>
		<pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool NetAspectAttribute = true;

    public static int LineNumber;

    public void BeforeCallMethod(int lineNumber)
    {
        LineNumber = lineNumber;
    }
}

public class Computer
{
    public static int Divide(int a, int b)
    {
        MyInt myInt = new MyInt(a);
        return myInt.DivideBy(b);
    }
}
</pre>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<p>Here is a sample with parameters</p>
	
	<pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool IsNetAspectAttribute { get { return true; } }
	
    public void Before(MyInt instance, int v) 
    {
        Console.WriteLine(string.Format("Start Division {0} / {1}", instance.Value, v));
    }
}
</pre>
	
	
	
	
<h3 id="dropdowns-example">Do something when an exception is raised in the method</h3>
    <p>Imagine that we want to print "Exception" in the console when the division raises an exception. We must modify our aspect like this</p>
	<pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool IsNetAspectAttribute { get { return true; } }
	
    public void OnException() { Console.WriteLine("Exception"); }
}
</pre>
	
	<p>You can add some parameters to your OnException method to get some information about the weaved method</p>	
	<ul>
		<li><b>instance</b> : same as the Before method</li>
		<li><b>method</b> : same as the Before method</li>
		<li><b>parameters</b> : same as the Before method</li>
		<li><b>parameter name</b> : same as the Before method</li>
		<li><b>exception</b> : the exception raised in the weaved method. The type of this parameter must be <b>System.Exception</b></li>
	</ul>

<h3 id="dropdowns-example">Do something after the method is executed (like onFinally)</h3>
    <p>Imagine that we want to print "End of division" in the console after the division is done or when the division raises an exception. We must modify our aspect like this</p>
	<pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool IsNetAspectAttribute { get { return true; } }
	
    public void OnFinally() { Console.WriteLine("End of division"); }
}
</pre>
	
	<p>You can add some parameters to your OnFinally method to get some information about the weaved method</p>	
	<ul>
		<li><b>instance</b> : same as the Before method</li>
		<li><b>method</b> : same as the Before method</li>
		<li><b>parameters</b> : same as the Before method</li>
		<li><b>parameter name</b> : same as the Before method</li>
	</ul>
</pre>

<h2 id="dropdowns">Getter/Setter Weaving</h2>
<p>You can add aspects by the same way to properties to weave getter et setter</p>
<h3 id="dropdowns-example">Weave the getter</h3>
	<pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool IsNetAspectAttribute { get { return true; } }
	
    public void BeforePropertyGetMethod() { Console.WriteLine("End of division"); }
}
</pre>
<p>The available parameters are :</p>	
	<ul>
		<li><b>instance</b> : same as the Before method</li>
		<li><b>property</b> : the weaved property. Must be of type PropertyInfo</li>
	</ul>

<h3 id="dropdowns-example">Weave the setter</h3>


	 <!-- Dropdowns
  ================================================== -->
  <div class="bs-docs-section">
    <div class="page-header">
      <h1 id="dropdowns">Call weaving</h1>
    </div>
    <p>The "call weaving" add aspects to the method which call our method and/or field so, you can access to the caller information</p>
	
    <h2 id="dropdowns-example">Setup</h2>
    <p>To define a NetAspect call attribute you must declare your attribute with a field named <b>NetAspectAttributeKind</b> like this :</p>
	<pre class="prettyprint">
public class LogOnCallAttribute : Attribute
{
    string NetAspectAttributeKind = "Call";
}
</pre>
<h3 id="dropdowns-example">The caller class</h3>
<pre class="prettyprint">
public class Math
{
  public int Divide(int dividend, int divisor)
  {
	 var myInt = new MyInt(dividend);
	 return myInt.DivideBy(divisor);
  }
}
</pre>
<h3 id="dropdowns-example">Link the method with the aspect</h3>
    <p>Now, just add the attribute to the member you wish.</p>
	<pre class="prettyprint">
public class MyInt
{
  private readonly int value;

  public MyInt(int value)
  {
	 this.value = value;
  }

  public int Value
  {
	 get { return value; }
  }

  [LogOnCall]
  public int DivideBy(int v)
  {
	 return value / v;
  }
}
</pre>
    
    <h2 id="dropdowns-example">Do something before the method is called</h2>
    <p>Imagine that we want to print in the console the type name of each caller to the DivideBy method.</p>
	<h3 id="dropdowns-example">Modify the aspect</h3>
    <p>We must modify our aspect like this</p>
	<pre class="prettyprint">
public class LogOnCallAttribute : Attribute
{
    string NetAspectAttributeKind = "Call";
	
    public void BeforeCall(object caller) { Console.WriteLine("Start Division by {0}", caller.GetType().Name); }
}
</pre>
	
    <h3 id="dropdowns-example-after">Parameters</h3>
	<p>You can add some parameters to your BeforeCall method to get some information.</p>	
	<ul>
		<li><b>caller</b> : the <i>this</i> of the caller. The type of instance can be <b>object</b> or the type of the caller</li>
		<li><b>TODO</b></li>
	</ul>
	
</div>
    
	
	
	<div class="bs-docs-section">
    <div class="page-header">
      <h1 id="dropdowns">Additional features</h1>
    </div>
    
    <h2 id="dropdowns-example">Scopes</h2>
	<p>TODO</p>
    <h2 id="dropdowns-example">Aspect lifecycle</h2>
    <p>TODO</p>
    
</div>
	
	
	  
	  </div>

    </div>



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="bootstrap-3.0.2/dist/js/bootstrap.min.js"></script>
	<script src="google-code-prettify/run_prettify.js"></script>
  </body>
</html>
