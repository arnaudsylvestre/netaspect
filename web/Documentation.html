<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png">

    <title>NetAspect</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap-3.0.2/dist/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="jumbotron.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
<!-- Docs page layout -->


<div class="container bs-docs-container">
      <div class="row">
        <div class="col-md-3">
          <div class="bs-sidebar hidden-print" role="complementary">
            <ul class="nav bs-sidenav" data-spy="affix" >
              
                <li>
  <a href="#attributes">Attributes</a>
  <ul class="nav" >
    <li><a href="#netaspect-attributes">NetAspect Attribute</a></li>
    <li><a href="#member-attributes">How to use</a></li>
  </ul>
</li>
<li>
  <a href="#dropdowns">Method Weaving</a>
  <ul class="nav">
    <li><a href="#dropdowns-example">Before method</a></li>
    <li><a href="#dropdowns-alignment">After method</a></li>
    <li><a href="#dropdowns-headers">OnException method</a></li>
  </ul>
</li>

            </ul>
          </div>
        </div>
        <div class="col-md-9" role="main">
            <!-- Glyphicons
  ================================================== -->
  <div class="bs-docs-section">
    <div class="page-header">
      <h1 id="attributes">Attributes</h1>
    </div>
    
	<h2 id="netaspect-attributes">NetAspect attribute</h2>
    <p>NetAspect use .Net attributes to define the weaving model. To define a NetAspect attribute you must declare your attribute with a property named <b>IsNetAspectAttribute</b> like this :</p>
	<pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool IsNetAspectAttribute { get { return true; } }
}
</pre>
    <h2 id="member-attributes">How to use</h2>
    <p>You can so put this attribute on a member to weave the method with your NetAspectAttribute</p>
    <pre class="prettyprint">
public class Computer
{
   [Log]
   public int Divide(int a, int b)
   {
      return a / b;
   }
}
</pre>
  </div>


  <!-- Dropdowns
  ================================================== -->
  <div class="bs-docs-section">
    <div class="page-header">
      <h1 id="dropdowns">Method weaving</h1>
    </div>
    
    <h2 id="dropdowns-example">Define your aspect</h2>
	<p>By adding a NetAspect attribute to a method, you can add behaviors in 3 locations : Before the code of the method, after the code of the method, handle if an exception occured</p>
	<pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool IsNetAspectAttribute { get { return true; } }
	
    public void Before() { Console.WriteLine("Before"); }
	
    public void After() { Console.WriteLine("After"); }
	
    public void OnException() { Console.WriteLine("OnException"); }
}
</pre>
	<p>After weaving, when any method will call your <b>Divide</b> method in your <b>Computer</b> class, the console will be filled !</p>
	
    <h2 id="dropdowns-example-after">Parameters</h2>
	<p>You can add some parameters to your Before/After/OnException methods to get some information about the weaved method</p>
	
    <h3 id="dropdowns-example">Parameters available in the Before method</h3>
	
	<ul>
		<li><b>instance</b> : the <i>this</i> of the weaved method (in our case the this of Divide). The type of instance can be <b>object</b> or <b>Computer</b> in our case</li>
		<li><b>method</b> : the MethodInfo of the weaved method (in our case Divide). The type of method must be <b>MethodInfo</b></li>
		<li><b>parameters</b> : the parameters of the weaved method (in our case the parameters of the Divide method). The type of parameters must be <b>object[]</b></li>
		<li><b>parameter name</b> : if a parameter name/type in the Before method is in the weaved method so the value will be the same. You can referenced the parameter in the aspect method to update the value in the weaved method</li>
	</ul>
	<p>Here is a sample of all the above parameters</p>
	
	<pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool IsNetAspectAttribute { get { return true; } }
	
    public void Before(Computer instance, MethodInfo method, object[] parameters, int a, ref int b) 
    {
        Console.WriteLine(string.Format("Before {0}", method.Name));
    }
}
</pre>
</div>

	  
	  </div>

    </div>



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="bootstrap-3.0.2/dist/js/bootstrap.min.js"></script>
	<script src="google-code-prettify/run_prettify.js"></script>
  </body>
</html>
