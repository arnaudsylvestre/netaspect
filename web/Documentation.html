<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="description" content="">
      <meta name="author" content="">
      <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png">
      <title>NetAspect</title>
      <link href="bootstrap-3.0.2/dist/css/bootstrap.css" rel="stylesheet">
      <link href="jumbotron.css" rel="stylesheet">
   </head>
   <body>
      <!-- 
================================================	  
	  Navigation
================================================
	  -->
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
         <div class="container">
            <div class="navbar-header">
               <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
               <span class="sr-only">Toggle navigation</span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               </button>
               <a class="navbar-brand" href="index.html">Home</a>
            </div>
            <div class="navbar-header">
               <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
               <span class="sr-only">Toggle navigation</span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               </button>
               <a class="navbar-brand" href="index.html">Net Aspect</a>
            </div>
            <div class="navbar-header">
               <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
               <span class="sr-only">Toggle navigation</span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               </button>
               <a class="navbar-brand" href="GettingStarted.html">Getting started</a>
            </div>
            <div class="navbar-header">
               <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
               <span class="sr-only">Toggle navigation</span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               </button>
               <a class="navbar-brand" href="Documentation.html">Documentation</a>
            </div>
         </div>
      </div>
      <div class="container bs-docs-container">
      <div class="row">
      <div class="col-md-12" role="main">
         <div class="bs-docs-section">
		 
      <!-- 
================================================	  
	  Basics
================================================
	  -->
		 
            <div class="page-header">
               <h1 id="attributes">Basics</h1>
            </div>
            <h3 id="dropdowns-example">The sample class</h3>
            <p>Imagine that we want to log the different access on the following class : </p>
            <pre class="prettyprint">
public class MyInt
{
   int value;
   
   public MyInt(int value)
   {
      this.value = value;
   }
   
   public int Value
   {
      get { return value; }
   }
   
   public int DivideBy(int v)
   {
      return value / v;
   }
}
</pre>
            <h3 id="dropdowns-example">Define the aspect</h3>
            <p>Imagine that we want to print <b>"Start Division"</b> in the console before executing the <b>DivideBy</b> method. We must create a class like this :</p>
            <pre class="prettyprint">
// NetAspect uses .Net attributes to define the weaving model
public class LogAttribute : Attribute
{
    // You must add this field to declare a NetAspectAttribute
    public bool NetAspectAttribute = true;
	
    // This method will be call before executing the DivideBy method thanks to the 'Before' method name
    public void Before() { Console.WriteLine("Start Division"); }
}
</pre>
            <h3 id="dropdowns-example">Link the method with the aspect</h3>
            <p>Now, just add the attribute to the DivideBy method</p>
            <pre class="prettyprint">
public class MyInt
{
  private readonly int value;

  public MyInt(int value)
  {
	 this.value = value;
  }

  public int Value
  {
	 get { return value; }
  }

  [Log]
  public int DivideBy(int v)
  {
	 return value / v;
  }
}
</pre>
         </div>

      <!-- 
================================================	  
	  Weaving
================================================
	  -->
         <div class="bs-docs-section">
            <div class="page-header">
               <h1 id="dropdowns">Weaving</h1>
            </div>
            <h2 id="dropdowns">Method Weaving</h2>
            <p>The "method weaving" will modify the code of the method to add behavior. It is possible to add behavior :</p>
            <ul>
               <li><b>Before</b> the method is executed</li>
               <li><b>After</b> the method is executed when no exception is raised</li>
               <li><b>When exception occurs</b> in the method</li>
               <li><b>On finally</b> : at the end of the method when an exception is raised or not</li>
            </ul>
            <p>For each of these behaviors, we can get some information about the weaved method by adding some parameters to the aspect method :</p>
            <ul>
               <li><b>instance</b> : the <i>this</i> of the weaved method.</li>
               <li><b>method</b> : the MethodInfo of the weaved method (in our case Divide)</li>
               <li><b>property</b> : the PropertyInfo of the property if the aspect is put on a property</li>
               <li><b>parameters</b> : the parameters of the weaved method.</li>
               <li><b>parameter name</b> : if a parameter name in the aspect method is in the weaved method so the value will be the same.</li>
               <li><b>result</b> : the value returned by the weaved method. The type of result must be the same type as the weaved method</li>
               <li><b>exception</b> : the exception raised in the weaved method.</b></li>
               <li><b>value</b> : the new value of the property in a property setter</li>
            </ul>
            <p>Here is a sample with parameters</p>
            <pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool IsNetAspectAttribute { get { return true; } }
	
    public void Before(MyInt instance, int v) 
    {
        Console.WriteLine(string.Format("Start Division {0} / {1}", instance.Value, v));
    }
}
</pre>
			<input type="button" class="btn btn-primary" data-toggle="collapse" data-target="#MethodWeavingPossibilities" value="Show possibilities">
    <!-- Collapsible Element HTML -->
    <div id="MethodWeavingPossibilities" class="collapse">
			
	
      <!-- 
================================================	  
	  MethodWeaving possibilities
================================================
	  -->
            <h4 id="dropdowns-example">On methods</h4>
            <p>These aspects are called when the aspect is put on a <b>method</b></p>
			
<div class="panel-group" id="GroupMethodWeaving">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingBefore">Before Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingBefore" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>Before</b> method is called before the method is executed. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>method</b> : The method</li>
               <li><b>parameters</b> : The parameters</li>
               <li><b>parameter name</b> : The parameter's name</li>
            </ul>
			<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;
	public void Before (object instance, MethodBase method, object[] parameters, int v)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual ("DivideBy", method.Name);
		Assert.AreEqual (1, parameters.Length);
		Assert.AreEqual (12, v);
	}
}


// The class to weave
public class MyInt
{
	int value;

	public MyInt (int value)
	{
		this.value = value;
	}

	public int Value {
		get {
			return value;
		}
	}

	[Log]
	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	var myInt = new MyInt (24);
	Assert.AreEqual (2, myInt.DivideBy (12));
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingAfter">After Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingAfter" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>After</b> method is called after the method is executed. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>method</b> : The method</li>
               <li><b>parameters</b> : The parameters</li>
               <li><b>parameter name</b> : The parameter's name</li>
               <li><b>result</b> : The result</li>
            </ul>
			<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;
	public void After (object instance, MethodBase method, object[] parameters, int v, int result)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual ("DivideBy", method.Name);
		Assert.AreEqual (1, parameters.Length);
		Assert.AreEqual (12, v);
		Assert.AreEqual (2, result);
	}
}


// The class to weave
public class MyInt
{
	int value;

	public MyInt (int value)
	{
		this.value = value;
	}

	public int Value {
		get {
			return value;
		}
	}

	[Log]
	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	var myInt = new MyInt (24);
	Assert.AreEqual (2, myInt.DivideBy (12));
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnException">On exception method weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnException" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnException</b> method is called when an exception occured in the method. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>method</b> : The method</li>
               <li><b>parameters</b> : The parameters</li>
               <li><b>parameter name</b> : The parameter's name</li>
               <li><b>exception</b> : The exception raised</li>
            </ul>
			<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void OnException (object instance, MethodBase method, object[] parameters, int v, Exception exception)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual ("DivideBy", method.Name);
		Assert.AreEqual (1, parameters.Length);
		Assert.AreEqual (0, v);
		Assert.AreEqual ("DivideByZeroException", exception.GetType ().Name);
	}
}


// The class to weave
public class MyInt
{
	int value;

	public MyInt (int value)
	{
		this.value = value;
	}

	public int Value {
		get {
			return value;
		}
	}

	[Log]
	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	try {
		var myInt = new MyInt (24);
		myInt.DivideBy (0);
		Assert.Fail ("Must raise an exception");
	}
	catch (DivideByZeroException) {
	}
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
		<div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnFinally">On finally method weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnFinally" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnFinally</b> method is called after the method is executed when an exception occured or not. The available parameters are :</p>
            <ul>
                <li><b>instance</b> : The instance</li>
               <li><b>method</b> : The method</li>
               <li><b>parameters</b> : The parameters</li>
               <li><b>parameter name</b> : The parameter's name</li>
            </ul>
						<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void OnFinally (object instance, MethodBase method, object[] parameters, int v)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual ("DivideBy", method.Name);
		Assert.AreEqual (1, parameters.Length);
		Assert.AreEqual (12, v);
	}
}


// The class to weave
public class MyInt
{
	int value;

	public MyInt (int value)
	{
		this.value = value;
	}

	public int Value {
		get {
			return value;
		}
	}

	[Log]
	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	var myInt = new MyInt (24);
	myInt.DivideBy (12);
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
            
    </div>
            
          
	
      <!-- 
================================================	  
	  ConstructorWeaving possibilities
================================================
	  -->  
            
            <h4 id="dropdowns-example">On constructors</h4>
            <p>These aspects are called when the aspect is put on a <b>constructor</b></p>
			
			<div class="panel-group" id="GroupConstructorWeaving">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#ConstructorWeavingBefore">Before Constructor Weaving possibilities</a>
                </h4>
            </div>
            <div id="ConstructorWeavingBefore" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>BeforeConstructor</b> method is called before the constructor is executed. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>constructor</b> : The constructor</li>
               <li><b>parameters</b> : The parameters</li>
               <li><b>parameter name</b> : The parameter's name</li>
            </ul>
<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void BeforeConstructor (object instance, MethodBase constructor, object[] parameters, int value)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual (".ctor", constructor.Name);
		Assert.AreEqual (1, parameters.Length);
		Assert.AreEqual (24, value);
	}
}


// The class to weave
public class MyInt
{
	int value;

	[Log]
	public MyInt (int value)
	{
		this.value = value;
	}

	public int Value {
		get {
			return value;
		}
	}

	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	var myInt = new MyInt (24);
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#ConstructordWeavingAfter">After Constructor Weaving possibilities</a>
                </h4>
            </div>
            <div id="ConstructordWeavingAfter" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>AfterConstructor</b> method is called after the constructor is executed. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>constructor</b> : The constructor</li>
               <li><b>parameters</b> : The parameters</li>
               <li><b>parameter name</b> : The parameter's name</li>
            </ul>
<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void AfterConstructor (object instance, MethodBase constructor, object[] parameters, int value)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual (".ctor", constructor.Name);
		Assert.AreEqual (1, parameters.Length);
		Assert.AreEqual (24, value);
	}
}


// The class to weave
public class MyInt
{
	int value;

	[Log]
	public MyInt (int value)
	{
		this.value = value;
	}

	public int Value {
		get {
			return value;
		}
	}

	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	var myInt = new MyInt (24);
	Assert.AreEqual (2, myInt.DivideBy (12));
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#ConstructorWeavingOnException">On exception constructor weaving possibilities</a>
                </h4>
            </div>
            <div id="ConstructorWeavingOnException" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnExceptionConstructor</b> method is called when an exception occured in the constructor. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>constructor</b> : The constructor</li>
               <li><b>parameters</b> : The parameters</li>
               <li><b>parameter name</b> : The parameter's name</li>
               <li><b>exception</b> : The exception raised</li>
            </ul>
<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void OnExceptionConstructor (object instance, MethodBase constructor, object[] parameters, int value, Exception exception)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual (".ctor", constructor.Name);
		Assert.AreEqual (1, parameters.Length);
		Assert.AreEqual (0, value);
		Assert.AreEqual ("DivideByZeroException", exception.GetType ().Name);
	}
}


// The class to weave
public class MyInt
{
	int value;

	[Log]
	public MyInt (int value)
	{
		if (value == 0)
			throw new Exception ();
		this.value = value;
	}

	public int Value {
		get {
			return value;
		}
	}

	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	try {
		new MyInt (0);
		Assert.Fail ("Must raise an exception");
	}
	catch (Exception) {
	}
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
		<div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#ConstructorWeavingOnFinally">On finally constructor weaving possibilities</a>
                </h4>
            </div>
            <div id="ConstructorWeavingOnFinally" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnFinallyConstructor</b> method is called after the constructor is executed when an exception occured or not. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>constructor</b> : The constructor</li>
               <li><b>parameters</b> : The parameters</li>
               <li><b>parameter name</b> : The parameter's name</li>
            </ul>
<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void OnFinallyConstructor (object instance, MethodBase constructor, object[] parameters, int value)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual (".ctor", constructor.Name);
		Assert.AreEqual (1, parameters.Length);
		Assert.AreEqual (24, value);
	}
}


// The class to weave
public class MyInt
{
	int value;

	[Log]
	public MyInt (int value)
	{
		this.value = value;
	}

	public int Value {
		get {
			return value;
		}
	}

	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	var myInt = new MyInt (24);
	myInt.DivideBy (12);
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
        
    </div>
		
      <!-- 
================================================	  
	  PropertyGetWeaving possibilities
================================================
	  -->  	
			
	<h4 id="dropdowns-example">On properties (For getter)</h4>
            <p>These aspects are called when the aspect is put on a <b>property</b></p>
			
<div class="panel-group" id="GroupPropertyGetWeaving">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#PropertyGetWeavingBefore">Before Property Getter possibilities</a>
                </h4>
            </div>
            <div id="PropertyGetWeavingBefore" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>BeforePropertyGetMethod</b> method is called before the get method of the property is executed. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>property</b> : The property</li>
            </ul>
<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void BeforePropertyGetMethod (object instance, PropertyInfo property)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual ("Value", property.Name);
	}
}


// The class to weave
public class MyInt
{
	int value;

	public MyInt (int value)
	{
		this.value = value;
	}

	[Log]
	public int Value {
		get {
			return value;
		}
	}

	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	var myInt = new MyInt (24);
	Assert.AreEqual (24, myInt.Value);
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#PropertyGetWeavingAfter">After Property Getter Weaving possibilities</a>
                </h4>
            </div>
            <div id="PropertyGetWeavingAfter" class="panel-collapse collapse">
                <div class="panel-body">
                <p>The <b>AfterPropertyGetMethod</b> method is called after the get method of the property is executed. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>property</b> : The property</li>
               <li><b>result</b> : The result</li>
            </ul>
<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void AfterPropertyGetMethod (object instance, PropertyInfo property, int result)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual ("Value", property.Name);
		Assert.AreEqual (24, result);
	}
}


// The class to weave
public class MyInt
{
	int value;

	public MyInt (int value)
	{
		this.value = value;
	}

	[Log]
	public int Value {
		get {
			return value;
		}
	}

	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	var myInt = new MyInt (24);
	Assert.AreEqual (24, myInt.Value);
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#PropertyGetWeavingOnException">On exception property get weaving possibilities</a>
                </h4>
            </div>
            <div id="PropertyGetWeavingOnException" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnExceptionPropertyGetMethod</b> method is called when an exception occured in the get method of the property. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>property</b> : The property</li>
               <li><b>exception</b> : The exception raised</li>
            </ul>
<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void OnExceptionPropertyGetMethod (object instance, PropertyInfo property, Exception exception)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual ("DivideBy", property.Name);
		Assert.AreEqual ("Exception", exception.GetType ().Name);
	}
}


// The class to weave
public class MyInt
{
	int value;

	public MyInt (int value)
	{
		this.value = value;
	}

	[Log]
	public int Value {
		get {
			if (value == 0)
				throw new Exception ("Must not be 0");
			return value;
		}
	}

	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	try {
		var myInt = new MyInt (0);
		var val = myInt.Value;
		Assert.Fail ("Must raise an exception");
	}
	catch (Exception) {
	}
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
		<div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#PropertyGetWeavingOnFinally">On finally property getter weaving possibilities</a>
                </h4>
            </div>
            <div id="PropertyGetWeavingOnFinally" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnFinallyPropertyGetMethod</b> method is called after the get method of the property is executed when an exception occured or not. The available parameters are :</p>
            <ul>
               <li><b>instance</b> : The instance</li>
               <li><b>property</b> : The property</li>
            </ul>
<p>Sample on how to use</p>
<pre class="prettyprint">
// The aspect
public class LogAttribute : Attribute
{
	public bool NetAspectAttribute = true;

	public static bool Called;

	public void OnFinallyPropertyGetMethod (object instance, PropertyInfo property)
	{
		Called = true;
		Assert.AreEqual (typeof(MyInt), instance.GetType ());
		Assert.AreEqual ("Value", property.Name);
	}
}


// The class to weave
public class MyInt
{
	int value;

	public MyInt (int value)
	{
		this.value = value;
	}

	[Log]
	public int Value {
		get {
			return value;
		}
	}

	public int DivideBy (int v)
	{
		return value / v;
	}
}


// The code which will call our aspect
{
	var myInt = new MyInt (24);
	var val = myInt.Value;
	Assert.True (LogAttribute.Called);
}
</pre>
                </div>
            </div>
        </div>
    </div>
	
	
      <!-- 
================================================	  
	  Property setter weaving possibilities
================================================
	  -->  	
			
			<h4 id="dropdowns-example">On property setter</h4>
            <p>These aspects are called when the aspect is put on a <b>property</b></p>
			
			<div class="panel-group" id="PropertySetterPossibilities">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingBeforePropertySetter">Before Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingBeforePropertySetter" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>BeforePropertySetMethod</b> method is called before the setter is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>value</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingAfterPropertySetter">After Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingAfterPropertySetter" class="panel-collapse collapse">
                <div class="panel-body">
            <p>The <b>AfterPropertySetMethod</b> method is called after the setter is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>value</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnExceptionPropertySetter">On Exception Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnExceptionPropertySetter" class="panel-collapse collapse">
                <div class="panel-body">
                    
            <p>The <b>OnExceptionPropertySetMethod</b> method is called when an exception occured in the setter. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>value</li>
               <li>exception</li>
            </ul>
                </div>
            </div>
        </div>
		<div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnFinallyPropertySetter">On Finally Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnFinallyPropertySetter" class="panel-collapse collapse">
                <div class="panel-body">
            <p>The <b>OnFinallyPropertySetMethod</b> method is called after the setter is executed when an exception occured or not. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>value</li>
            </ul>
                </div>
            </div>
        </div>
    </div>
	
			
    </div>
			            
            <h2 id="dropdowns">Call Weaving</h2>
            <h3 id="dropdowns-example">Theory in NetAspect</h3>
            <p>The "call weaving" will modify the code of the method which call the member with the aspect. It is possible to add the following behaviors :</p>
            <ul>
               <li><b>Before</b> the member is called</li>
               <li><b>After</b> the member is called</li>
            </ul>
            <p>For each of these behaviors, we can get some information about the caller and the member called by adding some parameters to the aspect method :</p>
            <ul>
               <li><b>caller</b> : the <i>this</i> of the method which call our member</li>
               <li><b>callerMethod</b> : the MethodInfo of the method which call our member</li>
               <li><b>callerParameters</b> : the parameters of the method which call our member</li>
               <li><b>caller + parameter name</b> : the parameter of the method which call our member</li>
               <li><b>called</b> : the <i>this</i> of our member</li>
               <li><b>calledParameters</b> : the parameters of our member if our member is a method</li>
               <li><b>called + parameter name</b> : the parameter of our member if our member is a method</li>
               <li><b>lineNumber</b> : the line number of the instruction which call our member</li>
               <li><b>columnNumber</b> : the column number of the instruction which call our member</li>
               <li><b>filePath</b> : the file path of the instruction which call our member</li>
               <li><b>fileName</b> : the file name of the instruction which call our member</li>
            </ul>
            <p>Here is a sample to get the line number of the code which call our DivideBy method</p>
            <pre class="prettyprint">
public class LogAttribute : Attribute
{
    public bool NetAspectAttribute = true;

    public static int LineNumber;

    public void BeforeCallMethod(int lineNumber)
    {
        LineNumber = lineNumber;
    }
}

public class Computer
{
    public static int Divide(int a, int b)
    {
        MyInt myInt = new MyInt(a);
        return myInt.DivideBy(b);
    }
}
</pre>
          
<input type="button" class="btn btn-primary" data-toggle="collapse" data-target="#CallWeavingPossibilities" value="Show possibilities">
    <!-- Collapsible Element HTML -->
    <div id="CallWeavingPossibilities" class="collapse">
			
	
      <!-- 
================================================	  
	  Method call weaving possibilities
================================================
	  -->
            <h4 id="dropdowns-example">On methods</h4>
            <p>These aspects are called when the aspect is put on a <b>method</b></p>
			
<div class="panel-group" id="MethodPossibilities">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingBefore">Before Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingBefore" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>BeforeMethod</b> method is called before the method is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>method</li>
               <li>parameters</li>
               <li>parameter name</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingAfter">After Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingAfter" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>AfterMethod</b> method is called after the method is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>method</li>
               <li>parameters</li>
               <li>parameter name</li>
               <li>result</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnException">On Exception Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnException" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnExceptionMethod</b> method is called when an exception occured in the method. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>method</li>
               <li>parameters</li>
               <li>parameter name</li>
               <li>exception</li>
            </ul>
                </div>
            </div>
        </div>
		<div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnFinally">On Finally Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnFinally" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnFinallyMethod</b> method is called after the method is executed when an exception occured or not. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>method</li>
               <li>parameters</li>
               <li>parameter name</li>
            </ul>
                </div>
            </div>
        </div>
    </div>
			
            
            
          
	
      <!-- 
================================================	  
	  Constructor weaving possibilities
================================================
	  -->  
            
            <h4 id="dropdowns-example">On constructors</h4>
            <p>These aspects are called when the aspect is put on a <b>constructor</b></p>
			
			<div class="panel-group" id="ConstructorPossibilities">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingBeforeConstructor">Before Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingBeforeConstructor" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>BeforeMethod</b> method is called before the method is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>method</li>
               <li>parameters</li>
               <li>parameter name</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingAfterConstructor">After Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingAfterConstructor" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>AfterMethod</b> method is called after the method is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>method</li>
               <li>parameters</li>
               <li>parameter name</li>
               <li>result</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnExceptionConstructor">On Exception Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnExceptionConstructor" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnExceptionMethod</b> method is called when an exception occured in the method. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>method</li>
               <li>parameters</li>
               <li>parameter name</li>
               <li>exception</li>
            </ul>
                </div>
            </div>
        </div>
		<div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnFinallyConstructor">On Finally Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnFinallyConstructor" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnFinallyMethod</b> method is called after the method is executed when an exception occured or not. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>method</li>
               <li>parameters</li>
               <li>parameter name</li>
            </ul>
                </div>
            </div>
        </div>
    </div>
		
      <!-- 
================================================	  
	  Property getter weaving possibilities
================================================
	  -->  	
			
			<h4 id="dropdowns-example">On property getter</h4>
            <p>These aspects are called when the aspect is put on a <b>property</b></p>
			
			<div class="panel-group" id="PropertyGetterPossibilities">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingBeforePropertyGetter">Before Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingBeforePropertyGetter" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>BeforePropertyGetMethod</b> method is called before the getter is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingAfterPropertyGetter">After Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingAfterPropertyGetter" class="panel-collapse collapse">
                <div class="panel-body">
                <p>The <b>AfterPropertyGetMethod</b> method is called after the getter is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>result</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnExceptionPropertyGetter">On Exception Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnExceptionPropertyGetter" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>OnExceptionPropertyGetMethod</b> method is called when an exception occured in the getter. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>exception</li>
            </ul>
                </div>
            </div>
        </div>
		<div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnFinallyPropertyGetter">On Finally Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnFinallyPropertyGetter" class="panel-collapse collapse">
                <div class="panel-body">
            <p>The <b>OnFinallyPropertyGetMethod</b> method is called after the getter is executed when an exception occured or not. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
            </ul>
                </div>
            </div>
        </div>
    </div>
	
	
      <!-- 
================================================	  
	  Property setter weaving possibilities
================================================
	  -->  	
			
			<h4 id="dropdowns-example">On property setter</h4>
            <p>These aspects are called when the aspect is put on a <b>property</b></p>
			
			<div class="panel-group" id="PropertySetterPossibilities">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingBeforePropertySetter">Before Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingBeforePropertySetter" class="panel-collapse collapse">
                <div class="panel-body">
                    <p>The <b>BeforePropertySetMethod</b> method is called before the setter is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>value</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingAfterPropertySetter">After Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingAfterPropertySetter" class="panel-collapse collapse">
                <div class="panel-body">
            <p>The <b>AfterPropertySetMethod</b> method is called after the setter is executed. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>value</li>
            </ul>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnExceptionPropertySetter">On Exception Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnExceptionPropertySetter" class="panel-collapse collapse">
                <div class="panel-body">
                    
            <p>The <b>OnExceptionPropertySetMethod</b> method is called when an exception occured in the setter. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>value</li>
               <li>exception</li>
            </ul>
                </div>
            </div>
        </div>
		<div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#MethodWeavingOnFinallyPropertySetter">On Finally Method Weaving possibilities</a>
                </h4>
            </div>
            <div id="MethodWeavingOnFinallyPropertySetter" class="panel-collapse collapse">
                <div class="panel-body">
            <p>The <b>OnFinallyPropertySetMethod</b> method is called after the setter is executed when an exception occured or not. The available parameters are :</p>
            <ul>
               <li>instance</li>
               <li>property</li>
               <li>value</li>
            </ul>
                </div>
            </div>
        </div>
    </div>
	
			
    </div>
			            
            
		  
            <div class="bs-docs-section">
               <div class="page-header">
                  <h1 id="dropdowns">Additional features</h1>
               </div>
               <h2 id="dropdowns-example">Scopes</h2>
               <p>TODO</p>
               <h2 id="dropdowns-example">Aspect lifecycle</h2>
               <p>TODO</p>
            </div>
         </div>
      </div>
      <!-- Bootstrap core JavaScript
         ================================================== -->
      <!-- Placed at the end of the document so the pages load faster -->
      <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
      <script src="bootstrap-3.0.2/dist/js/bootstrap.min.js"></script>
      <script src="google-code-prettify/run_prettify.js"></script>
   </body>
</html>
